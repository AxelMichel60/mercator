$("#vendor-selector").select2({placeholder:"Start typing to search",tags:!0,ajax:{url:"/admin/cpe/search/vendors",dataType:"json",delay:250,data:function(t){return{part:window.cpePart,search:t.term||""}},processResults:function(t){return{results:t.map(function(e){return{id:e.name,text:e.name}})}},cache:!0},minimumInputLength:1});$("#product-selector").select2({placeholder:"Start typing to search",tags:!0,ajax:{url:"/admin/cpe/search/products",dataType:"json",delay:250,data:function(t){return{part:window.cpePart,vendor:$("#vendor-selector").val(),search:t.term||""}},processResults:function(t){return{results:t.map(function(e){return{id:e.name,text:e.name}})}},cache:!0},minimumInputLength:0});$("#version-selector").select2({placeholder:"Start typing to search",tags:!0,ajax:{url:"/admin/cpe/search/versions",dataType:"json",delay:250,data:function(t){return{part:window.cpePart,vendor:$("#vendor-selector").val(),product:$("#product-selector").val(),search:t.term||""}},processResults:function(t){return{results:t.map(function(e){return{id:e.name,text:e.name}})}},cache:!0},minimumInputLength:0});function c(t){let e='<div style="max-height: 300px; overflow-y: scroll;">';return e+='<table class="table compact">',e+="<thead><tr><th>Vendor</th><th>Product</th><th></th></tr></thead>",t.forEach(function(r){e+="<tr>",e+="<td>"+r.vendor_name+"</td>",e+="<td>"+r.product_name+"</td>",e+='<td><a class="select_cpe" data-vendor="'+r.vendor_name+'" data-product="'+r.product_name+'" href="#"> <i class="bi bi-window-plus" style="color:green"></i></a>',e+="</td>",e+="</tr>"}),e+="</table></div>",e}$("#guess").click(function(t){let e=$("#name").val();console.log(e),$.get("/admin/cpe/search/guess?search="+encodeURIComponent(e)).then(r=>Swal.fire({title:"Matching",html:c(r),didOpen(s){$(".select_cpe").on("click",function(o){o.preventDefault();let n=$(this).data("vendor");$("#vendor-selector").append("<option>"+n+"</option>"),$("#vendor-selector").val(n);let a=$(this).data("product");$("#product-selector").append("<option>"+a+"</option>"),$("#product-selector").val(a),$("#version-selector").append("<option></option>"),$("#version-selector").val(null),Swal.close()})},showConfirmButton:!1,showCancelButton:!0,customClass:{container:{"max-height":"6em","overflow-y":"scroll",width:"100%"}}}))});
